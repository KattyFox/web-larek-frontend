# Проектная работа "Веб-ларек"


Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

### **Основные компоненты:**

#### **1. Модели данных:**

**ItemModel (Товар)**

typescript

{

title: string; // Название товара

category: string; // Категория

description: string; // Описание

imageUrl: string; // URL изображения

price: number; // Цена

}

Отвечает за:

-   Хранение информации о товаре

-   Единое представление продукта в системе

**ShopModel (Каталог)**

typescript

{

items: ItemModel\[\]; // Все товары магазина

}

Отвечает за:

-   Хранение полного ассортимента

-   Поиск и фильтрацию товаров

**OrderModel (Заказ)**

typescript

{

payCard: boolean; // Способ оплаты

payCash: boolean;

address: string; // Данные доставки

email: string;

phone: string;

items: ItemModel\[\]; // Состав заказа

totalPrice: number; // Итоговая сумма

}

Отвечает за:

-   Оформленные заказы

-   Расчет итоговой стоимости

#### **2. Представление:**

**PayView**

-   Отображает интерфейс оплаты

-   Связано с OrderModel для получения данных

-   Использует HTML-шаблон (template)

### **Ключевые взаимосвязи:**

1.  **Агрегация товаров**:

    -   ShopModel содержит множество ItemModel (1 → \*)

    -   BinModel (корзина) содержит множество ItemModel (1 → \*)

    -   OrderModel содержит множество ItemModel (1 → \*)

2.  **Использование данных**:

    -   PayView использует данные из OrderModel (1 → 1)

### **Особенности архитектуры:**

1.  **Централизованная модель товара**:

    -   ItemModel используется во всех компонентах системы

    -   Единообразное представление продукта

2.  **Разделение ответственности**:

    -   ShopModel - каталог товаров

    -   BinModel - временное хранение выбора

    -   OrderModel - завершенные транзакции

3.  **Гибкость**:

    -   Легкое добавление новых полей в ItemModel

    -   Возможность расширения функционала

### **Паттерны:**

1.  **Композиция**:

    -   Модели высшего уровня содержат коллекции ItemModel

2.  **Singleton** (подразумевается):

    -   ShopModel и BinModel обычно существуют в единственном экземпляре

3.  **Data Transfer Object**:

    -   ItemModel служит для передачи данных между слоями

### **Возможные улучшения:**

1.  Добавить:

    -   Валидацию полей моделей

    -   Методы расчета скидок в OrderModel

    -   Историю изменений цен в ItemModel

2.  Оптимизировать:

    -   Загрузку изображений (ленивая загрузка)

    -   Хранение больших коллекций товаров

3.  Расширить:

    -   Систему категорий (древовидную структуру)

    -   Мультиязычные описания

Эта архитектура обеспечивает:\
✔ Согласованность данных во всей системе\
✔ Легкую интеграцию новых модулей\
✔ Эффективную работу с товарными данными\
✔ Масштабируемость решения

![](media/image1.png){width="4.947916666666667in" height="5.6875in"}

#### **Взаимодействие Моделей с Отображениями и Контроллерами:  I.I. OrderModel** 

1.  **OrderModel** -- хранит данные заказа:

    -   Способ оплаты (payCard, payCash)

    -   Контактные данные (address, email, phone)

    -   Состав заказа (items, totalPrice)

2.  **PayView** -- отображает форму выбора способа оплаты.

3.  **ContactView** -- форма ввода контактных данных.

4.  **OrderDoneView** -- экран подтверждения успешного оформления
    > заказа.

5.  **OrderController** -- управляет процессом:

    -   Переключает экраны (startPay(), startContactView(),
        > startOrderDoneView()).

    -   Обрабатывает завершение заказа (orderDone()).

#### **Взаимодействие:**

-   **OrderModel** передает данные во все представления (PayView,
    > ContactView, OrderDoneView).

-   **OrderController** координирует переходы между экранами и обработку
    > данных.

-   Представления (PayView, ContactView, OrderDoneView) используют
    > шаблоны (HTMLTemplateElement) для рендеринга и отправляют события
    > через eventDispatcher.

**Процесс:**

1.  Пользователь выбирает способ оплаты (PayView).

2.  Вводит контактные данные (ContactView).

3.  После подтверждения (OrderController.orderDone()) отображается экран
    > успешного заказа (OrderDoneView).

Система обеспечивает четкое разделение данных (OrderModel), отображения
(Views) и логики (OrderController).

![](media/image7.png){width="6.267716535433071in"
height="2.6527777777777777in"}

**II. ItemModel**

#### **Основные компоненты:**

1.  **ItemModel** -- модель данных товара:

    -   title -- название товара.

    -   category -- категория.

    -   description -- описание.

    -   imageUrl -- ссылка на изображение.

    -   price -- цена.

2.  **OrderModel** -- модель заказа (содержит массив ItemModel\[\]).

    -   Также включает данные оплаты (payCard, payCash), контакты
        > (address, email, phone), общую стоимость (totalPrice).

    -   Метод reset() -- очистка данных заказа.

3.  **BinModel** -- модель корзины:

    -   Список товаров (items: ItemModel\[\]).

    -   Метод createCard() -- создает карточку товара в корзине.

4.  **Представления товара:**

    -   **ItemShopView** -- отображение товара в магазине (использует
        > ShopController).

    -   **ItemCompactView** -- компактная карточка товара (например, в
        > списках).

    -   **ItemPopupView** -- всплывающее окно с деталями товара.

#### **Взаимодействие:**

-   **ItemModel** передается в:

    -   ItemShopView, ItemCompactView, ItemPopupView -- для отображения
        > в разных форматах.

    -   BinModel -- для добавления в корзину.

    -   OrderModel -- для формирования заказа.

-   Представления (ItemShopView, ItemCompactView, ItemPopupView)
    > используют **HTML-шаблоны** (HTMLTemplateElement) для рендеринга и
    > могут отправлять события через eventDispatcher.

**Процесс:**

1.  Товар (ItemModel) отображается в магазине (ItemShopView), в
    > компактном виде (ItemCompactView) или во всплывающем окне
    > (ItemPopupView).

2.  При добавлении в корзину (BinModel) товар попадает в список items.

3.  При оформлении заказа (OrderModel) товары из корзины переносятся в
    > заказ.

Система обеспечивает:

-   Гибкое отображение товара в разных интерфейсах.

-   Связь между товарами, корзиной и заказом.

-   Использование шаблонов для единообразия визуального представления.

![](media/image5.png){width="6.267716535433071in"
height="2.0972222222222223in"}

**III. BinModel**

### **Описание компонентов:**

1.  **BinModel** (Модель):

    -   Хранит состояние корзины: массив товаров (items: ItemModel\[\]).

    -   Метод createCard() (возможно, создает виртуальную \"карту\"
        > заказа).

2.  **BinController** (Контроллер):

    -   Управляет логикой: добавление/удаление товаров (addItem(),
        > removeItem()), проверка наличия (containsItem()).

    -   Координирует обновление представлений:

        -   binIconView (иконка корзины с количеством товаров).

        -   binView (полное отображение корзины).

        -   popupView (всплывающие уведомления).

    -   Использует eventDispatcher (например, кастомные события) для
        > связи между компонентами.

3.  **Представления (View):**

    -   **BinView**:

        -   Рендерит основное содержимое корзины (список товаров через
            > ItemCompactView).

        -   Метод create() генерирует HTML-структуру на основе template.

    -   **BinIconView**:

        -   Отображает иконку корзины (например, в шапке сайта) и
            > обновляет счетчик товаров (updBinQuantityItems()).

### **Взаимодействие:**

-   **Модель (BinModel)** оповещает **Контроллер (BinController)** об
    > изменениях.

-   **Контроллер** обновляет **Представления** (BinView, BinIconView,
    > PopupView).

-   **Представления** могут отправлять события (через eventDispatcher)
    > для обратной связи.

### **Паттерны и особенности:**

-   **Классический MVC** с модификациями (если View слушают Model
    > напрямую).

-   **Event-Driven Architecture** (использование eventDispatcher для
    > слабой связанности).

-   **Reactive Updates** (иконка корзины автоматически обновляется при
    > изменении модели).

### **Альтернативные названия:**

-   **\"Корзина с декомпозированным UI и контроллером\"**

-   **\"Event-based Cart Management System\"**

![](media/image3.png){width="6.267716535433071in"
height="2.9166666666666665in"}

**IV. ShopModel**

### **Описание компонентов:**

#### **1. ShopModel (Модель данных)**

-   **Хранит массив товаров (items: ItemModel\[\]).**

-   **Служит источником данных для ShopView и ShopController.**

#### **2. ShopView (Представление каталога)**

-   **Отвечает за отображение товаров на странице.**

-   **Содержит:**

    -   **container (HTML-элемент для рендеринга).**

    -   **itemShopView (компонент отображения отдельного товара).**

-   **Методы:**

    -   **appendCard() -- добавляет карточку товара.**

    -   **append() -- общий метод для вставки контента (возможно, для
        > пагинации или фильтрации).**

#### **3. ShopController (Контроллер логики)**

-   **Управляет взаимодействием пользователя с каталогом:**

    -   **clickOnShopItemToShow() -- открывает детали товара (например,
        > через PopupView).**

    -   **clickOnShopItemToAddToBasket() -- добавляет товар в корзину
        > (через binController).**

    -   **clickOnShopItemToRemoveToBasket() -- удаляет товар из
        > корзины.**

-   **Использует:**

    -   **popup и itemPopupView для показа деталей товара.**

    -   **binController для связи с корзиной.**

    -   **eventDispatcher для обработки событий (например, кликов).**

### **Взаимодействие:**

-   **Поток данных:\
    > ShopModel → (ShopView \| ShopController) → (Рендеринг или
    > действия).**

-   **Поток событий:\
    > Пользователь кликает на товар → ShopController обрабатывает
    > действие → Обновляет BinController или показывает PopupView.**

### **Особенности архитектуры:**

-   **Слабая связанность:**

    -   **ShopController делегирует работу с корзиной binController, а
        > не управляет ей напрямую.**

    -   **Использование eventDispatcher позволяет гибко обрабатывать
        > события.**

-   **Reactive-подход:**

    -   **Если ShopModel изменится (например, фильтрация), ShopView
        > автоматически обновит интерфейс.**

### **Возможные аналогии/паттерны:**

1.  **MVC с делегированием:**

    -   **Контроллер (ShopController) не содержит бизнес-логику, а
        > перенаправляет запросы.**

2.  **Mediator (Посредник):**

    -   **ShopController выступает посредником между ShopView и
        > BinController.**

3.  **Observer:**

    -   **Если ShopView подписывается на изменения ShopModel (не
        > показано, но возможно).**

### Итоговая таблица связей:

  -------------------------------------------------------------------------
  Model        View                            Назначение
  ------------ ------------------------------- ----------------------------
  ItemModel    ItemShopView, ItemCompactView,  Отображение товара в разных
               ItemPopupView                   вариантах

  BinModel     BinView, BinIconView            Корзина и её иконка

  OrderModel   PayView, ContactView,           Этапы оформления заказа
               OrderDoneView                   

  ShopModel    ShopView                        Главная страница магазина
  -------------------------------------------------------------------------

Взаимодействие Вьюх и контроллеров\
\
II.1

ShopController

### **Ключевые компоненты:**

#### **1. ShopController (Главный контроллер магазина)**

-   **Зависимости**:

    -   ShopModel (данные товаров).

    -   BinController (управление корзиной).

    -   PopupView (всплывающие окна).

-   **Методы**:

    -   clickOnShopItemToShow() -- открывает попап с деталями товара
        > (PopupView + itemPopupView).

    -   clickOnShopItemToAddToBasket() / RemoveToBasket() -- делегирует
        > действия в BinController.

-   **Роль**:

    -   Центральный координатор между каталогом товаров, корзиной и
        > UI-элементами.

#### **2. BinController (Контроллер корзины)**

-   Управляет:

    -   BinModel (состояние корзины).

    -   BinView / BinIconView (отображение корзины и иконки).

    -   PopupView (уведомления).

-   **Методы**:

    -   addItem() / removeItem() -- изменение состава корзины.

    -   updateIcon() -- обновление счетчика в иконке.

#### **3. ShopModel (Модель данных магазина)**

-   Просто хранит массив товаров (items: ItemModel\[\]).

#### **4. PopupView (Вспомогательное View)**

-   Отвечает за показ/скрытие модальных окон (show(), hide()).

### **Взаимодействие:**

1.  Пользователь кликает на товар в магазине →

    -   ShopController обрабатывает событие:

        -   Показывает детали (PopupView).

        -   Добавляет/удаляет товар через BinController.

2.  BinController обновляет:

    -   Состояние корзины (BinModel).

    -   UI (BinView, BinIconView).

### **Особенности архитектуры:**

-   **Разделение ответственности**:

    -   ShopController не управляет корзиной напрямую, а делегирует это
        > BinController.

-   **Использование событий**:

    -   Оба контроллера используют eventDispatcher для коммуникации
        > (слабая связанность).

-   **Переиспользуемые компоненты**:

    -   PopupView используется как для деталей товара, так и для
        > уведомлений корзины.

### **Паттерны:**

1.  **Facade (Фасад)**:

    -   ShopController упрощает сложные взаимодействия (корзина, попапы)
        > для внешнего кода.

2.  **Mediator (Посредник)**:

    -   ShopController согласует работу BinController и PopupView.

3.  **Observer/Event-Driven**:

    -   Общение через eventDispatcher (например, клик → событие →
        > обработка).

![](media/image6.png){width="6.267716535433071in"
height="4.611111111111111in"}

**BinControler**

#### **1. BinModel (Модель данных корзины)**

-   **Содержит**:\
    > typescript

```{=html}
<!-- -->
```
-   items: ItemModel\[\] // Список товаров в корзине

-   **Отвечает за**:

    -   Хранение текущего состояния корзины

    -   Предоставление данных о товарах

#### **2. BinController (Контроллер логики)**

-   **Управляет**:

    -   BinModel (данные корзины)

    -   BinView (полное отображение корзины)

    -   BinIconView (иконка корзины)

    -   PopupView (всплывающие уведомления)

-   **Основные методы**:

    -   addItem() - добавление товара в корзину

    -   removeItem() - удаление товара из корзины

    -   showBin() - отображение полной корзины

    -   updateIcon() - обновление иконки корзины

#### **3. Представления (View)**

-   **BinView (Полное отображение корзины)**:

    -   Использует шаблон (template) для рендеринга

    -   Содержит компоненты ItemCompactView для отображения отдельных
        > товаров

    -   Основной метод create() - создает интерфейс корзины

-   **BinIconView (Иконка корзины)**:

    -   Отображает количество товаров через htmlBinElement

    -   Метод updBinQuantityItems() обновляет счетчик товаров

### **Взаимодействие компонентов:**

1.  **Пользовательское действие** (например, добавление товара):

    -   Вызывается метод BinController.addItem()

2.  **Обновление модели**:

    -   Контроллер изменяет данные в BinModel

3.  **Обновление интерфейса**:

    -   Контроллер инициирует обновление BinView и BinIconView

4.  **Отображение изменений**:

    -   BinView перерисовывает список товаров

    -   BinIconView обновляет счетчик

### **Ключевые особенности архитектуры:**

-   **Четкое разделение ответственности**:

    -   Модель хранит данные

    -   Контроллер управляет логикой

    -   Представления отвечают за отображение

-   **Гибкость**:

    -   Возможность изменять отдельные компоненты без влияния на другие

    -   Легкое добавление новых видов представлений

-   **Масштабируемость**:

    -   Простое добавление новой функциональности (например, валидации
        > товаров)

![](media/image4.png){width="6.267716535433071in"
height="3.5555555555555554in"}

### **Детализация компонентов:**

#### **1. OrderModel (Модель данных заказа)**

Содержит все критически важные данные:

typescript
  
{

payCard: boolean; // Оплата картой

payCash: boolean; // Оплата наличными

address: string; // Адрес доставки

email: string; // Контактный email

phone: string; // Контактный телефон

items: ItemModel\[\]; // Позиции заказа

totalPrice: number; // Итоговая сумма

}

Отвечает за:

-   Хранение состояния заказа

-   Валидацию основных данных

-   Расчет итоговой суммы

#### **2. Представления (Views)**

Каждое представление отвечает за свой этап оформления:

**PayView (Оплата)**

-   Отображает выбор способа оплаты

-   Использует HTML-шаблон (template)

-   Связано с OrderModel для получения/сохранения данных

**ContactView (Контакты)**

-   Форма ввода контактных данных

-   Основной метод create() генерирует интерфейс

-   Взаимодействует с моделью через eventDispatcher

**OrderDoneView (Подтверждение)**

-   Финальный экран с подтверждением заказа

-   Метод create() показывает итоговую информацию

#### **3. OrderController (Главный контроллер)**

Координирует весь процесс:

-   Управляет переходами между этапами (PayView → ContactView →
    > OrderDoneView)

-   Синхронизирует данные между View и Model

-   Обрабатывает события от всех представлений

### **Схема взаимодействия:**

1.  Пользователь начинает оформление:

    -   OrderController инициализирует PayView

2.  При переходе между этапами:

    -   Контроллер сохраняет данные в OrderModel

    -   Инициирует создание следующего View

3.  На финальном этапе:

    -   OrderDoneView показывает сводку на основе OrderModel

### **Ключевые особенности:**

1.  **Последовательный workflow**:

    -   Четкое разделение на этапы оформления

    -   Контроллер управляет потоком выполнения

2.  **Централизованное хранение данных**:

    -   Все представления работают с единой OrderModel

3.  **Гибкость отображения**:

    -   Каждое View имеет собственный шаблон

    -   Возможность кастомизации отдельных этапов

### **Паттерны проектирования:**

1.  **State Machine**:

    -   Каждый View представляет состояние процесса

2.  **Mediator**:

    -   OrderController выступает посредником между компонентами

3.  **Observer**:

    -   Использование eventDispatcher для коммуникации

![](media/image2.png){width="6.267716535433071in"
height="1.8888888888888888in"}

### **События в проекте**

#### **1. Стандартные события**

Эти события уже существуют в DOM и используются для взаимодействия с
элементами:

  ---------------------------------------------------------------------------
  **Событие**   **Где используется**            **Назначение**
  ------------- ------------------------------- -----------------------------
  click         BinIconView, ItemShopView,      Обработка кликов по кнопкам,
                ItemPopupView, OrderDoneView,   карточкам товаров, корзине.
                PayView, ContactView            

  input         PayView, ContactView            Отслеживание ввода данных в
                                                поля формы (адрес, email,
                                                телефон).
  ---------------------------------------------------------------------------

#### **2. Кастомные события**

Эти события создаются вручную для связи между компонентами:

  --------------------------------------------------------------------------------
  **Событие**       **Где создается     **Где обрабатывается    **Назначение**
                    (dispatchEvent)**   (addEventListener)**    
  ----------------- ------------------- ----------------------- ------------------
  showBin           BinIconView → клик  BinController →         Показывает
                    по иконке корзины   открывает корзину       модальное окно
                                                                корзины.

  addToBin          ItemPopupView →     ShopController →        Добавляет товар в
                    кнопка \"В          добавляет товар в       BinModel.
                    корзину\"           корзину                 

  removeFromBin     ItemPopupView →     ShopController →        Удаляет товар из
                    кнопка \"Удалить\"  удаляет товар из        BinModel.
                                        корзины                 

  buyButtonBin      BinView → кнопка    BinController →         Передает список
                    \"Оформить заказ\"  запускает процесс       товаров в
                                        оплаты                  OrderController.

  startPay          BinController →     OrderController →       Начинает процесс
                    после buyButtonBin  инициализирует оплату   оформления заказа.

  payViewDone       PayView → кнопка    OrderController →       Переход от оплаты
                    \"Далее\"           переключает на          к вводу контактов.
                                        контактные данные       

  contactViewDone   ContactView →       OrderController →       Переход к
                    кнопка              завершает заказ         финальному экрану.
                    \"Подтвердить\"                             

  orderDone         OrderDoneView →     BinController → очищает Завершает заказ,
                    кнопка \"Закрыть\"  корзину,                очищает данные.
                                        OrderController →       
                                        отправляет заказ        
  --------------------------------------------------------------------------------

### **Как работают кастомные события?**

1.  **Создание события** (new CustomEvent):\
    > ts

eventDispatcher.addEventListener(\"addToBin\", (e) =\> {

console.log(\"Товар добавлен:\", e.detail);

1.  });

### **САММАРИ**

-   **Стандартные события** (click, input) используются для базового
    > взаимодействия с DOM.

-   **Кастомные события** (addToBin, orderDone) обеспечивают связь между
    > модулями (например, между View и Controller).

-   **Паттерн Event Bus**: eventDispatcher (HTMLElement) выступает как
    > центральный шинопровод для событий.

const event = new CustomEvent(\"addToBin\", { detail: item });

**Отправка события** (dispatchEvent):\
ts

this.eventDispatcher.dispatchEvent(event);

**Обработка события** (addEventListener):\
ts
